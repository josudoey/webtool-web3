(self.webpackChunkwebtool_web3=self.webpackChunkwebtool_web3||[]).push([[4],{214:()=>{},568:()=>{},326:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(278),a=r(764),n=r(550),o=r(266);const c=r(94).keccak_256,i=a.lW,l=o.ec,u=window.ec=new l("secp256k1");function d(e){return"string"!=typeof e?e:function(e){if("string"!=typeof e)throw new Error("[is-hex-prefixed] value must be type 'string', is currently type "+typeof e+", while checking isHexPrefixed.");return"0x"===e.slice(0,2)}(e)?e.slice(2):e}const h=function(e){return new n(f(e)).toNumber()},f=function(e){if(null==e)return i.allocUnsafe(0);if(i.isBuffer(e))return i.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return i.from(e);if("string"==typeof e){if("string"!=typeof(t=e)||!t.match(/^0x[0-9A-Fa-f]*$/)||r&&t.length!==2+2*r)throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return i.from(function(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}(d(e)),"hex")}var t,r;return i.from(str,"hex")},m=window.fromRpcSig=function(e){const t=f(e);let r,s,a;if(t.length>=65)r=t.slice(0,32),s=t.slice(32,64),a=h(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),s=t.slice(32,64),a=h(t.slice(32,33))>>7,s[0]&=127}return a<27&&(a+=27),{v:a,r,s}},g=window.hashPersonalMessage=function(e){const t=i.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return i.from(c(i.concat([t,e])),"hex")},v=window.personalRecover=function(e,t){const r=g(i.from(e,"utf-8")),s=m(t),a=u.recoverPubKey(r,s,s.v-27).encode("hex",!1),n=i.from(a,"hex").slice(1);return`0x${i.from(c(n),"hex").slice(-20).toString("hex")}`},p=function(e,t){const r=d(e).toLowerCase();let s="";if(t){s=new n(t).toString()+"0x"}const a=c(s+r);let o="0x";for(let e=0;e<r.length;e++)parseInt(a[e],16)>=8?o+=r[e].toUpperCase():o+=r[e];return o};const b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fluid px-0"},[e._m(0),r("div",{staticClass:"container-fluid px-0"},[e.ethereum&&e.ethereum.isMetaMask?r("metamask-card"):r("a",{attrs:{href:"https://metamask.io/"}},[r("img",{attrs:{src:"https://metamask.io/images/mm-logo.svg"}}),e._v("Install")])],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("nav",{staticClass:"navbar navbar-dark bg-dark"},[r("div",{staticClass:"navbar-brand d-flex"},[r("div",[e._v("Webtool Web3")])])])}],components:{MetamaskCard:{render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-card",[r("b-card-title",[e._v("MetaMask")]),e.ethereum.selectedAddress?r("b-card-body",[r("span",[e._v("Current Address: "+e._s(e._f("toChecksumAddress")(e.ethereum.selectedAddress)))]),r("br"),null===e.balance&&e.getBalance(e.ethereum.selectedAddress)?r("b-icon",{attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e(),null!==e.balance?r("span",[e._v("Balance: "+e._s(e._f("ether")(e.balance))+" Ether"),r("b-btn",{staticClass:"p-0",attrs:{variant:"primary"},on:{click:function(t){return e.getBalance(e.ethereum.selectedAddress)}}},[r("b-icon-arrow-repeat")],1)],1):e._e(),r("b-form-input",{attrs:{placeholder:"to address"},model:{value:e.transferToAddress,callback:function(t){e.transferToAddress=t},expression:"transferToAddress"}}),r("b-form-input",{attrs:{placeholder:"transfer amount(ether)"},model:{value:e.transferEther,callback:function(t){e.transferEther=t},expression:"transferEther"}}),r("b-btn",{attrs:{variant:"primary"},on:{click:function(t){return e.transfer(e.transferToAddress,e.transferEther)}}},[e._v("transfer")]),e.transactionHash?r("b-alert",{attrs:{show:""}},[e._v("tx hash: "+e._s(e.transactionHash))]):e._e(),r("hr"),r("b-form-textarea",{attrs:{placeholder:"message"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),r("b-btn",{attrs:{variant:"primary"},on:{click:function(t){return e.personalSign(e.message)}}},[e._v("personalSign")]),e.messageSignature?r("b-alert",{attrs:{show:""}},[e._v("message signature: "+e._s(e.messageSignature))]):e._e(),r("hr"),r("b-form-textarea",{attrs:{placeholder:"recover message"},model:{value:e.recoverMessage,callback:function(t){e.recoverMessage=t},expression:"recoverMessage"}}),r("b-form-textarea",{attrs:{placeholder:"recover signature"},model:{value:e.recoverSignature,callback:function(t){e.recoverSignature=t},expression:"recoverSignature"}}),r("b-btn",{attrs:{variant:"primary"},on:{click:function(t){return e.personalRecover(e.recoverMessage,e.recoverSignature)}}},[e._v("personalRecover")]),e.recoverAddress?r("b-alert",{attrs:{show:""}},[e._v("recover address: "+e._s(e.recoverAddress))]):e._e()],1):r("b-card-body",[r("b-btn",{attrs:{variant:"primary"},on:{click:e.requestAccounts}},[e._v("requestAccounts")])],1)],1)},staticRenderFns:[],inject:["ethereum"],data:()=>({accounts:[],balance:null,transferToAddress:"",transferEther:"",transactionHash:"",message:"",messageSignature:"",recoverMessage:"",recoverSignature:"",recoverAddress:""}),async mounted(){const{ethereum:e}=this;await this.getAccounts()},updated(){},filters:{ether:e=>s.fromWei(e,"ether"),toChecksumAddress:e=>p(e)},methods:{async request(e){const{ethereum:t}=this;return t.request(e)},async requestAccounts(){try{this.accounts=await this.request({method:"eth_requestAccounts"})}catch(e){this.$bvToast.toast(e.message,{title:"存取失敗",autoHideDelay:3e3,appendToast:!0})}},async getAccounts(){this.accounts=await this.request({method:"eth_accounts"})},async getBalance(e){const{ethereum:t}=this;console.log("getBalance",e),e=e||t.selectedAddress;const r=this.balance=await this.request({method:"eth_getBalance",params:[e,"latest"]});return console.log(e,r),r},async transfer(e,t){const{ethereum:r}=this,a=s.toWei(t,"ether");try{const t={to:e,from:r.selectedAddress,value:`0x${a.toString(16)}`,data:""};console.log(t);const s=this.transactionHash=await this.request({method:"eth_sendTransaction",params:[t]});console.log(s)}catch(e){this.$bvToast.toast(e.message,{title:"發送失敗",autoHideDelay:3e3,appendToast:!0}),console.log(e)}},async personalSign(e,t){const{ethereum:r}=this,s={method:"personal_sign",params:[e,t=t||r.selectedAddress]};console.log(s);const a=this.messageSignature=await r.request(s);console.log(a)},async personalRecover(e,t){this.recoverAddress=p(v(e,t))}}}},provide(){const e={};return Object.defineProperties(e,{ethereum:{get:()=>window.ethereum}}),e},data:()=>({ethereum:null}),mounted(){this.ethereum=window.ethereum},updated(){},methods:{}}}}]);